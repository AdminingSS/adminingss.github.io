"use strict";!function(o,e,n){function s(o){var e=[];for(var n in o)e.push(encodeURIComponent(n)+"="+encodeURIComponent(o[n]));return e.join("&")}function r(o){for(var e=o+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){for(var r=n[s];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null}o[n]=o[n]||{},"undefined"!=typeof Storage&&(o[n].debug=!!localStorage.getItem("sndsyApi_developMode"));var d=function(d,l){if(o[n].debug&&console.group("Sendsay"),o[n].debug&&console.log("Call %s:",d,l),o[n].debug&&console.log("Env before:",o[n]),"init"===d){if(o[n].debug&&console.groupCollapsed("Init"),o[n].fid=l.fid,o[n].dhost=l.dhost||"link.sendsay.ru",e.referrer){o[n].debug&&console.log("Referer: ",e.referrer);var t=e.referrer.substr(e.referrer.indexOf("://")+3),c=t.split("?")[0].split("/");c[3]&&c[1]&&4===c[3].split(",").length&&c[1]===o[n].fid&&(o[n].plc=c[3],o[n].host=c[0],document.cookie="_sndsy_fid="+o[n].fid+"; path=/;domain=."+location.host.replace("www.",""),document.cookie="_sndsy_host="+o[n].host+"; path=/;domain=."+location.host.replace("www.",""),document.cookie="_sndsy_plc="+o[n].plc+"; path=/;domain=."+location.host.replace("www.",""),o[n].debug&&console.log("Set cookie: ",document.cookie))}void 0===o[n].plc&&r("_sndsy_fid")===o[n].fid&&(o[n].debug&&console.log("Read cookie"),o[n].plc=r("_sndsy_plc"),o[n].host=r("_sndsy_host")),o[n].debug&&console.groupEnd()}else if("send"===d&&(o[n].plc||l.email)){o[n].debug&&console.groupCollapsed("Send");var i=("https:"==e.location.protocol?"https:":"http:")+"//";Array.isArray(l.dk)&&(l.dk=JSON.stringify(l.dk)),l.url=l.url||e.location,o[n].plc&&(l.plc=o[n].fid+","+o[n].plc);var u=new XMLHttpRequest,a=i+o[n].dhost+"/"+o[n].fid+"/0/?"+s(l);o[n].debug&&console.log("Url: ",a),o[n].debug&&console.log("Params: ",l);try{u.open("GET",a,!0),u.send(),o[n].debug&&console.log("Sent")}catch(g){console.error("Sandsay tracking error. URL: "+a)}o[n].debug&&console.groupEnd()}o[n].debug&&console.log("Env after: ",o[n]),o[n].debug&&console.groupEnd()};for(var l in o.sndsy.q)d.apply(null,o.sndsy.q[l]);o.sndsy=d}(window,document,"sndsy_params");